# Как выложить сайт в интернет (для доступа друзей)

Сайт можно разместить на **Render.com** (есть бесплатный тариф). После деплоя все работают по одному адресу: и интерфейс, и API, и картинки.

---

## 0. Перед деплоем

- Убедись, что в `public/` есть `img2.jpg` для фона на странице входа (если нет — при сборке будет тёмный фон).
- Данные (`server/data/db.json`) и загруженные портреты (`server/uploads/`) в репозиторий не попадают — на первом деплое база будет пустая (только пользователь `admin`).

---

## 1. Репозиторий на GitHub

1. Создайте репозиторий на [github.com](https://github.com).
2. В корне проекта `dnd-site` выполните:

```bash
cd dnd-site
git init
git add .
git commit -m "DnD site"
git branch -M main
git remote add origin https://github.com/ВАШ_ЛОГИН/ИМЯ_РЕПО.git
git push -u origin main
```

(Подставьте свой логин и имя репозитория.)

---

## 2. Регистрация и деплой на Render

1. Зайдите на [render.com](https://render.com) и войдите через GitHub.
2. **Dashboard** → **New** → **Web Service**.
3. Подключите свой репозиторий и нажмите **Connect**.
4. Настройте сервис:

| Поле | Значение |
|------|----------|
| **Name** | например `dnd-campaign` |
| **Region** | ближайший (например Frankfurt) |
| **Root Directory** | оставить пустым |
| **Runtime** | Node |
| **Build Command** | `npm install && npm run build && cd server && npm install` |
| **Start Command** | `cd server && node index.js` |

5. **Environment** (переменные):

| Key | Value |
|-----|-------|
| `JWT_SECRET` | придумайте длинную случайную строку (например: `openssl rand -hex 32` в терминале) |

6. Нажмите **Create Web Service**.

После сборки Render выдаст URL вида: `https://dnd-campaign-xxxx.onrender.com` — этим адресом можно пользоваться.

---

## 3. Что сказать друзьям

- Адрес: `https://ВАШ-СЕРВИС.onrender.com`
- Логин и пароль ты создаёшь в админке (кроме первого входа: `admin` / `6852`; пароль лучше сменить или завести своих пользователей и от админа отказаться по необходимости).

---

## 4. Ограничения бесплатного тарифа Render

- **«Засыпание»**: если сайтом не пользовались ~15 минут, следующий запрос может открываться 30–60 секунд. Для редких игр это обычно нормально.
- **Данные и файлы**: `db.json` и картинки в `server/uploads/` хранятся на диске сервиса. При перезапуске/пересборке они могут обнуляться. Для постоянного хранения нужна отдельная БД (MongoDB, PostgreSQL и т.п.) и внешнее хранилище для картинок.
- **Трафик**: на бесплатном тарифе есть лимиты. Для небольшой компании друзей их обычно хватает.

---

## 5. Смена пароля admin и безопасность

1. Зайди под `admin` / `6852`.
2. В админке создай нового пользователя с надёжным паролем и нужными правами.
3. При желании создай себе отдельного админа, зайди под ним, после чего пользователя `admin` можно удалить вручную в `server/data/db.json` (или не использовать).

В production обязательно задай `JWT_SECRET` в Environment и не храни пароли в коде.

---

## 6. Как это устроено технически

- При **Build** выполняется `npm run build` (Vite собирает React в `dist/`) и `cd server && npm install`.
- При **Start** запускается `node server/index.js`.
- Если в корне проекта есть папка `dist` с `index.html`, сервер сам раздаёт фронтенд и для маршрутов вроде `/`, `/login`, `/admin` отдаёт `index.html` (SPA). Запросы к `/api` и `/uploads` обрабатывает только backend.

Локально по-прежнему можно работать как раньше:  
`npm run dev` (фронт) и `node server/index.js` (бэк).
